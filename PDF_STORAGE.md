# PDF文件存储功能说明

## 功能概述

现在系统会自动保存上传的PDF简历文件，在筛查历史记录的详情页面中，除了查看AI分析结果，还可以直接查看原始PDF简历。

## 实现方式

- **存储方式**：PDF文件转换为base64编码后存储在Neon数据库的JSONB字段中
- **存储位置**：`history_records` 表的 `pdf_files` 列
- **数据格式**：
  ```json
  [
    {
      "fileName": "张三_简历.pdf",
      "data": "base64编码的PDF数据",
      "size": 524288
    }
  ]
  ```

## 数据库更新步骤

1. 登录 [Neon Console](https://console.neon.tech/)
2. 选择你的项目和数据库
3. 打开 SQL Editor
4. 执行以下SQL命令：

```sql
ALTER TABLE history_records ADD COLUMN IF NOT EXISTS pdf_files JSONB;
```

或者直接运行项目中的迁移脚本：`db/add_pdf_files_column.sql`

## 存储空间说明

- **Neon免费套餐**：3GB存储空间
- **平均PDF大小**：约500KB
- **可存储数量**：约6000个PDF文件
- **当前使用场景**：完全够用，无需额外费用

## 功能特点

1. **自动保存**：每次筛查时自动保存所有上传的PDF文件
2. **跨设备访问**：PDF文件存储在数据库中，任何设备登录都能查看
3. **流转支持**：记录流转后，接收人可以查看原始PDF简历
4. **在线预览**：直接在浏览器中预览PDF，无需下载

## 使用方法

1. 上传PDF简历并完成筛查
2. 在"筛查历史"页面点击"详情"按钮
3. 在详情页面顶部会显示"原始简历PDF"区域
4. PDF会自动在iframe中加载显示

## 注意事项

- 旧的历史记录（更新前创建的）不包含PDF文件
- 新创建的筛查记录会自动包含PDF文件
- PDF文件大小会计入数据库存储空间
- 建议定期清理不需要的历史记录以节省空间
